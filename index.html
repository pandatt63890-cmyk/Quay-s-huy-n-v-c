<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Huyền Vực - Xích Ma Giới</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { 
            --main-red: #D32F2F; /* Đỏ hoàng gia */
            --dark-red: #8B0000;
            --gold: #FFD700;
            --bg-black: #1A1A1A;
        }

        body { 
            background: var(--bg-black); 
            color: #ffffff; 
            font-family: 'Inter', sans-serif; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            min-height: 100vh; 
            margin: 0; 
            padding: 20px;
        }

        .container { 
            text-align: center; 
            padding: 40px 25px; 
            border-radius: 20px; 
            background: #262626; 
            border: 2px solid var(--main-red);
            box-shadow: 0 0 30px rgba(211, 47, 47, 0.3); 
            width: 100%; 
            max-width: 400px; 
        }

        h1 { 
            font-weight: 900; 
            font-size: 2em; 
            margin: 0; 
            color: var(--main-red);
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 0 10px rgba(211, 47, 47, 0.5);
        }

        .sub {
            font-size: 0.75em;
            color: var(--gold);
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: 700;
        }

        #result-display { 
            font-size: 1.5em; 
            min-height: 120px; 
            margin: 20px 0; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            text-align: center; 
            font-weight: 700; 
            background: rgba(211, 47, 47, 0.1);
            border: 1px solid rgba(211, 47, 47, 0.3);
            border-radius: 12px;
            padding: 20px;
            color: #ffffff;
            line-height: 1.4;
        }
        
        .spin-btn { 
            background: var(--main-red); 
            color: #fff; 
            border: none; 
            padding: 18px; 
            font-size: 1.1em; 
            font-weight: 800;
            cursor: pointer; 
            border-radius: 10px; 
            transition: 0.3s; 
            width: 100%; 
            text-transform: uppercase;
            box-shadow: 0 4px 0 var(--dark-red);
        }

        .spin-btn:hover:not(:disabled) {
            background: #FF5252;
            transform: translateY(-2px);
        }

        .spin-btn:active {
            transform: translateY(2px);
            box-shadow: none;
        }

        .spin-btn:disabled { 
            background: #444; 
            color: #888; 
            box-shadow: none;
            cursor: not-allowed; 
        }
        
        .reset-btn { 
            background: transparent; 
            color: #666; 
            border: none;
            padding: 10px; 
            font-size: 0.7em; 
            cursor: pointer; 
            margin-top: 25px;
            font-weight: 700;
            text-transform: uppercase;
            text-decoration: underline;
        }

        .status { 
            font-size: 0.75em; 
            color: #888; 
            margin-top: 10px; 
            font-weight: 600; 
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>HUYỀN VỰC</h1>
        <div class="sub">XÍCH MA GIỚI - ĐỊNH MỆNH</div>
        
        <div id="result-display">NHẤN QUAY ĐỂ KHỞI ĐẦU</div>
        
        <button id="spinBtn" class="spin-btn" onclick="startSpin()">KHAI THIÊN LẬP ĐỊA</button>
        
        <div class="status" id="countDisplay">Đang triệu hồi...</div>
        <button class="reset-btn" onclick="resetSystem()">KHÔI PHỤC DANH SÁCH</button>
    </div>

    <script>
        // Key mới để không bị kẹt bộ nhớ cũ
        const STORAGE_KEY = 'HUYENVUC_RED_V1';

        const rawData = [
            { name: "Hoàng Đế Trường Minh Quốc", qty: 1 },
            { name: "Hoàng Hậu Trường Minh Quốc", qty: 1 },
            { name: "Thái tử Trường Minh Quốc", qty: 1 },
            { name: "Ma Thần Ma Giới", qty: 1 },
            { name: "Thập Nhị Tà Thần", qty: 12 },
            { name: "Thanh Long Thần Thú", qty: 1 },
            { name: "Huyền Vũ Thần Thú", qty: 1 },
            { name: "Chu Tước Thần Thú", qty: 1 },
            { name: "Bạch Vô Thường", qty: 1 },
            { name: "Quốc Sư", qty: 1 },
            { name: "Thừa Tướng", qty: 1 },
            { name: "Nguyên Soái", qty: 1 },
            { name: "Đại phu Làng Yên Hạ", qty: 2 },
            { name: "Đại phu Làng Giang Yết", qty: 2 },
            { name: "Đại phu Làng Đoan Di", qty: 2 }
        ];

        function createList() {
            let list = [];
            rawData.forEach(i => { for(let n=0; n<i.qty; n++) list.push(i.name); });
            return list;
        }

        let chars = JSON.parse(localStorage.getItem(STORAGE_KEY)) || createList();

        function refreshUI() {
            document.getElementById('countDisplay').innerText = "CĂN CỐT CÒN LẠI: " + chars.length;
            const b = document.getElementById('spinBtn');
            if(chars.length === 0) {
                document.getElementById('result-display').innerText = "VẠN VẬT ĐÃ AN BÀI";
                b.disabled = true;
            } else { b.disabled = false; }
        }

        function startSpin() {
            const btn = document.getElementById('spinBtn');
            const display = document.getElementById('result-display');
            btn.disabled = true;
            
            let i = 0;
            const timer = setInterval(() => {
                display.innerText = chars[Math.floor(Math.random() * chars.length)];
                i++;
                if(i > 20) {
                    clearInterval(timer);
                    const idx = Math.floor(Math.random() * chars.length);
                    const winner = chars[idx];
                    
                    display.innerHTML = "<span style='color:var(--gold); font-size:0.7em; display:block; margin-bottom:5px;'>KẾT QUẢ TRIỆU HỒI</span>" + winner;
                    
                    chars.splice(idx, 1);
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(chars));
                    refreshUI();
                    btn.disabled = false;
                }
            }, 60);
        }

        function resetSystem() {
            if(confirm("Làm mới lại toàn bộ danh sách?")) {
                chars = createList();
                localStorage.setItem(STORAGE_KEY, JSON.stringify(chars));
                document.getElementById('result-display').innerText = "NHẤN QUAY ĐỂ KHỞI ĐẦU";
                refreshUI();
            }
        }

        refreshUI();
    </script>
</body>
</html>
